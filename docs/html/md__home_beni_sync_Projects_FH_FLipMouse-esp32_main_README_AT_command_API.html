<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FLipMouse/FABI ESP32 firmware: AT-commands / Communication API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FLipMouse/FABI ESP32 firmware
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">AT-commands / Communication API </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The FLipmouse firmware provides 4 different USB HID device classes:</p><ul>
<li>Mouse</li>
<li>Keyboard</li>
<li>Joystick</li>
<li>Serial CDC</li>
</ul>
<p>All configuration is done via the serial interface, which provides the persistent configuration of all functionalities and in addition a live mode (e.g. write "mouse move" to the serial port and the firmware moves the mouse cursor).</p>
<p>The serial port configuration is <b>115200 8N1</b> (even these settings are not necessary due to the USB encapsulation).</p>
<p><b>Note:</b></p>
<p>The ESP32 chip itself does NOT have a USB connection. Therefore, we integrated a second USB chip on the FABI/FLipMouse PCB, which handles USB to Serial / Serial to HID translation. The corresponding firmware for this chip (LPC11U14) is located here: <a href="https://github.com/benjaminaigner/usb_bridge">usb_bridge repository</a></p>
<p><b>Note:</b> Please note that all following commands, which do NOT have a fct_* file or are done via a handler, cannot be assigned to a virtual button (via AT BM). These commands can be used to configure the FLipMouse/FABI, in a macro or for slot management.</p>
<p>Following commands are currently available:</p>
<p><b>General Commands</b> </p><table class="doxtable">
<tr>
<th align="left">Command </th><th align="left">Parameter </th><th align="left">Description </th><th align="left">Available since </th><th align="left">Implemented in v3 </th><th align="left">fct_* file / handler  </th></tr>
<tr>
<td align="left">AT </td><td align="left">&ndash; </td><td align="left">returns OK </td><td align="left">v2 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT ID </td><td align="left">&ndash; </td><td align="left">returns the current version string </td><td align="left">v2 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT BM </td><td align="left">number (0-VB_MAX-1) </td><td align="left">set the button, which corresponds to the next command. The button assignments are described on the bottom </td><td align="left">v2 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT BL </td><td align="left">number (0,1) </td><td align="left">enable/disable output of triggered virtual buttons. Is used with AT BM for command learning </td><td align="left">v3 </td><td align="left">untested </td><td align="left">no (handled in task_debouncer) </td></tr>
<tr>
<td align="left">AT MA </td><td align="left">string </td><td align="left">execute macro (';' separated list of commands, see <a href="https://github.com/asterics/FLipMouse/wiki/macros">Macros</a>) <sup><a href="#footnoteA">A</a></sup> </td><td align="left">v2 </td><td align="left">yes </td><td align="left">fct_macros </td></tr>
<tr>
<td align="left">AT WA </td><td align="left">number (0-30000) </td><td align="left">wait/delay (ms); useful for macros. Does nothing if not used in macros. </td><td align="left">v2 </td><td align="left">yes </td><td align="left">yes/no <sup><a href="#footnoteB">B</a></sup> </td></tr>
<tr>
<td align="left">AT RO </td><td align="left">number (0,90,180,270) </td><td align="left">orientation (0 =&gt; LEDs on top) </td><td align="left">v2 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT KL </td><td align="left">number </td><td align="left">Set keyboard locale (locale defines are listed below) </td><td align="left">v3 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT BT </td><td align="left">number (0,1,2,3) </td><td align="left">Bluetooth mode, 0=no HID output, 1=USB only, 2=BT only, 3=both(default) </td><td align="left">v2 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT TT </td><td align="left">number (100-5000) </td><td align="left">Threshold time ([ms]) between short and long press actions. Set to 5000 to disable. </td><td align="left">v3 </td><td align="left">no </td><td align="left">no (handled in task_debouncer) </td></tr>
<tr>
<td align="left">AT AP </td><td align="left">number (1-500) </td><td align="left">Antitremor delay for button press ([ms]) <sup><a href="#footnoteC">C</a></sup> </td><td align="left">v3 </td><td align="left">untested </td><td align="left">no </td></tr>
<tr>
<td align="left">AT AR </td><td align="left">number (1-500) </td><td align="left">Antitremor delay for button release ([ms]) <sup><a href="#footnoteC">C</a></sup></td><td align="left">v3 </td><td align="left">untested </td><td align="left">no </td></tr>
<tr>
<td align="left">AT AI </td><td align="left">number (1-500) </td><td align="left">Antitremor delay for button idle ([ms]) <sup><a href="#footnoteC">C</a></sup></td><td align="left">v3 </td><td align="left">untested </td><td align="left">no </td></tr>
<tr>
<td align="left">AT FR </td><td align="left">&ndash; </td><td align="left">Reports free, used and available config storage space (e.g., "FREE:10%,9000,1000")</td><td align="left">v3 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT FB </td><td align="left">number (0,1,2,3) </td><td align="left">Feedback mode, 0=no LED/no buzzer, 1=LED/no buzzer, 2=no LED/buzzer, 3= LED + buzzer </td><td align="left">v3 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT PW </td><td align="left">string </td><td align="left">Set a new wifi password. Use at least <b>8</b> characters </td><td align="left">v3 </td><td align="left">untested </td><td align="left">no </td></tr>
<tr>
<td align="left">AT FW </td><td align="left">number (2,3) </td><td align="left">Update firmware. 2 = update ESP32; 3 = update LPC </td><td align="left">v3 </td><td align="left">untested </td><td align="left">no </td></tr>
</table>
<p><a class="anchor" id="footnoteA"></a><b>A</b>: If you want to have a semicolon character WITHIN an AT command, please escape it with a backslash sequence: "\;". All other characters can be used normally.</p>
<p><a class="anchor" id="footnoteB"></a><b>B</b>: AT WA is done in fct_macros, but cannot be used in any other way except a macro ( <em>AT MA</em> ).</p>
<p><a class="anchor" id="footnoteC"></a><b>C</b>: Either combine the anti-tremor time settings with a previously sent <em>AT BM</em> command to set a debouncing time for an individual virtual button <b>OR</b> use this command individually to set a global value.</p>
<p><b>USB HID Commands</b> </p><table class="doxtable">
<tr>
<th align="left">Command </th><th align="left">Parameter </th><th align="left">Description </th><th align="left">Available since </th><th align="left">Implemented in v3 </th><th align="left">fct_* file / handler  </th></tr>
<tr>
<td align="left">AT CL </td><td align="left">&ndash; </td><td align="left">Click left mouse button </td><td align="left">v2 </td><td align="left">yes </td><td align="left">handler_hid </td></tr>
<tr>
<td align="left">AT CR </td><td align="left">&ndash; </td><td align="left">Click right mouse button </td><td align="left">v2 </td><td align="left">yes </td><td align="left">handler_hid </td></tr>
<tr>
<td align="left">AT CM </td><td align="left">&ndash; </td><td align="left">Click middle mouse button </td><td align="left">v2 </td><td align="left">yes </td><td align="left">handler_hid </td></tr>
<tr>
<td align="left">AT CD </td><td align="left">&ndash; </td><td align="left">Doubleclick left mouse button </td><td align="left">v2 </td><td align="left">yes </td><td align="left">handler_hid </td></tr>
<tr>
<td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr>
<tr>
<td align="left">AT HL/AT PL </td><td align="left">&ndash; </td><td align="left">Press+hold left mouse button (if assigned to a VB, release depends on button release) </td><td align="left">v2 </td><td align="left">yes </td><td align="left">handler_hid </td></tr>
<tr>
<td align="left">AT HR/AT PR </td><td align="left">&ndash; </td><td align="left">Press+hold right mouse button (if assigned to a VB, release depends on button release) </td><td align="left">v2 </td><td align="left">yes </td><td align="left">handler_hid </td></tr>
<tr>
<td align="left">AT HM/AT PM </td><td align="left">&ndash; </td><td align="left">Press+hold middle mouse button (if assigned to a VB, release depends on button release) </td><td align="left">v2 </td><td align="left">yes </td><td align="left">handler_hid </td></tr>
<tr>
<td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr>
<tr>
<td align="left">AT RL </td><td align="left">&ndash; </td><td align="left">Release left mouse button </td><td align="left">v2 </td><td align="left">yes </td><td align="left">handler_hid </td></tr>
<tr>
<td align="left">AT RR </td><td align="left">&ndash; </td><td align="left">Release right mouse button </td><td align="left">v2 </td><td align="left">yes </td><td align="left">handler_hid </td></tr>
<tr>
<td align="left">AT RM </td><td align="left">&ndash; </td><td align="left">Release middle mouse button </td><td align="left">v2 </td><td align="left">yes </td><td align="left">handler_hid </td></tr>
<tr>
<td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr>
<tr>
<td align="left">AT TL </td><td align="left">&ndash; </td><td align="left">Toggle left mouse button </td><td align="left">v2 </td><td align="left">yes </td><td align="left">handler_hid </td></tr>
<tr>
<td align="left">AT TR </td><td align="left">&ndash; </td><td align="left">Toggle right mouse button </td><td align="left">v2 </td><td align="left">yes </td><td align="left">handler_hid </td></tr>
<tr>
<td align="left">AT TM </td><td align="left">&ndash; </td><td align="left">Toggle middle mouse button </td><td align="left">v2 </td><td align="left">yes </td><td align="left">handler_hid </td></tr>
<tr>
<td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr>
<tr>
<td align="left">AT WU </td><td align="left">&ndash; </td><td align="left">Move mouse wheel up </td><td align="left">v2 </td><td align="left">yes </td><td align="left">handler_hid </td></tr>
<tr>
<td align="left">AT WD </td><td align="left">&ndash; </td><td align="left">Move mouse wheel down </td><td align="left">v2 </td><td align="left">yes </td><td align="left">handler_hid </td></tr>
<tr>
<td align="left">AT WS </td><td align="left">number (1-127) </td><td align="left">Set mousewheel stepsize (e.g.: "AT WS 3" sets the stepsize to 3 rows)</td><td align="left">v2 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr>
<tr>
<td align="left">AT MX </td><td align="left">number </td><td align="left">Move mouse (X direction), e.g. AT MX -25 </td><td align="left">v2 </td><td align="left">yes </td><td align="left">handler_hid </td></tr>
<tr>
<td align="left">AT MY </td><td align="left">number </td><td align="left">Move mouse (Y direction), e.g. AT MY 10 </td><td align="left">v2 </td><td align="left">yes </td><td align="left">handler_hid </td></tr>
<tr>
<td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr>
<tr>
<td align="left">AT KW </td><td align="left">string </td><td align="left">Keyboard write (e.g. "AT KW Hi" types "Hi") </td><td align="left">v2 </td><td align="left">yes </td><td align="left">handler_hid </td></tr>
<tr>
<td align="left">AT KP </td><td align="left">string </td><td align="left">Key press ("click") (e.g. "AT KP KEY_UP" presses &amp; releases the up arrow key), a full list of supported key identifiers is provided on the bottom. </td><td align="left">v2 </td><td align="left">yes </td><td align="left">handler_hid </td></tr>
<tr>
<td align="left">AT KH </td><td align="left">string </td><td align="left">Key hold (e.g. "AT KH KEY_UP" presses &amp; holds the up arrow key.), a full list of supported key identifiers is provided on the bottom </td><td align="left">v2 </td><td align="left">untested </td><td align="left">handler_hid </td></tr>
<tr>
<td align="left">AT KR </td><td align="left">string </td><td align="left">Key release (e.g. "AT KR KEY_UP" releases the up arrow key) </td><td align="left">v2 </td><td align="left">untested </td><td align="left">handler_hid </td></tr>
<tr>
<td align="left">AT KT </td><td align="left">string </td><td align="left">Key toggle (e.g. "AT KT KEY_UP" toggles the up arrow key) </td><td align="left">v2 </td><td align="left">untested </td><td align="left">handler_hid </td></tr>
<tr>
<td align="left">AT RA </td><td align="left">&ndash; </td><td align="left">Release all keys </td><td align="left">v2 </td><td align="left">untested </td><td align="left">no </td></tr>
</table>
<p><b>Storage commands</b> </p><table class="doxtable">
<tr>
<th align="left">Command </th><th align="left">Parameter </th><th align="left">Description </th><th align="left">Available since </th><th align="left">Implemented in v3 </th><th align="left">fct_* file / handler  </th></tr>
<tr>
<td align="left">AT SA </td><td align="left">string </td><td align="left">save current configuration at the next free EEPROM slot under the give name (e.g. "AT SA mouse" stores a slot with the name "mouse" </td><td align="left">v2 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT LO </td><td align="left">string </td><td align="left">load a configuration from the EEPROM (e.g. "AT LO mouse") </td><td align="left">v2 </td><td align="left">yes </td><td align="left">handler_vb </td></tr>
<tr>
<td align="left">AT LA </td><td align="left">&ndash; </td><td align="left">load all slots and print the configuration. Note: if no slot is available, this command initializes the mouse slot (this is only active if ACTIVATE_V25_COMPAT is defined) </td><td align="left">v2 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT LI </td><td align="left">&ndash; </td><td align="left">list all available slots </td><td align="left">v2 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT NE </td><td align="left">&ndash; </td><td align="left">load next slot (wrap around after the last slot) </td><td align="left">v2 </td><td align="left">yes </td><td align="left">handler_vb </td></tr>
<tr>
<td align="left">AT DE </td><td align="left">&ndash; </td><td align="left">delete all slots </td><td align="left">v2 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT DL </td><td align="left">number (0-250) </td><td align="left">delete one slot. </td><td align="left">v3 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT DN </td><td align="left">string </td><td align="left">delete one slot by name </td><td align="left">v3 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT NC </td><td align="left">&ndash; </td><td align="left">do nothing </td><td align="left">v2 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT E0 </td><td align="left">&ndash; </td><td align="left">disable debug output </td><td align="left">v2 </td><td align="left">never, use make monitor </td><td align="left">- </td></tr>
<tr>
<td align="left">AT E1 </td><td align="left">&ndash; </td><td align="left">enable debug output </td><td align="left">v2 </td><td align="left">never, use make monitor </td><td align="left">- </td></tr>
<tr>
<td align="left">AT E2 </td><td align="left">&ndash; </td><td align="left">enable debug output (extended) </td><td align="left">v2 </td><td align="left">never, use make monitor </td><td align="left">- </td></tr>
</table>
<p><b>Mouthpiece settings</b> </p><table class="doxtable">
<tr>
<th align="left">Command </th><th align="left">Parameter </th><th align="left">Description </th><th align="left">Available since </th><th align="left">Implemented in v3 </th><th align="left">fct_* file / handler  </th></tr>
<tr>
<td align="left">AT MM </td><td align="left">number (0,1,2,3) </td><td align="left">use the mouthpiece either as mouse cursor (AT MM 1), alternative function (AT MM 0), joystick (AT MM 2) or disable it (AT MM 3) </td><td align="left">v2 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT SW </td><td align="left">&ndash; </td><td align="left">switch between cursor and alternative mode </td><td align="left">v2 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT SR </td><td align="left">&ndash; </td><td align="left">start reporting out the raw sensor values ("VALUES:&lt;pressure&gt;,&lt;up&gt;,&lt;down&gt;,&lt;left&gt;,&lt;right&gt;,&lt;x&gt;,&lt;y&gt;" </td><td align="left">v2 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT ER </td><td align="left">&ndash; </td><td align="left">stop reporting the sensor values </td><td align="left">v2 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT CA </td><td align="left">&ndash; </td><td align="left">trigger zeropoint calibration </td><td align="left">v2 </td><td align="left">yes </td><td align="left">handler_vb </td></tr>
<tr>
<td align="left">AT AX </td><td align="left">number (0-100) </td><td align="left">sensitivity x-axis </td><td align="left">v2 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT AY </td><td align="left">number (0-100) </td><td align="left">sensitivity y-axis </td><td align="left">v2 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT AC </td><td align="left">number (0-100) </td><td align="left">acceleration </td><td align="left">v2 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT MS </td><td align="left">number (0-100) </td><td align="left">maximum speed </td><td align="left">v2 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT DX </td><td align="left">number (0-10000) </td><td align="left">deadzone x-axis </td><td align="left">v2 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT DY </td><td align="left">number (0-10000) </td><td align="left">deadzone y-axis </td><td align="left">v2 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT TS </td><td align="left">number (0-512) </td><td align="left">sip action threshold </td><td align="left">v2 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT SS </td><td align="left">number (0-512) </td><td align="left">strong-sip action threshold </td><td align="left">v2 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT TP </td><td align="left">number (512-1023) </td><td align="left">puff action threshold </td><td align="left">v2 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT SP </td><td align="left">number (512-1023) </td><td align="left">strong-puff action threshold </td><td align="left">v2 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT OT </td><td align="left">number (0-15) </td><td align="left">On-the-fly calibration, threshold for detecting idle </td><td align="left">v3 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT OC </td><td align="left">number (5-15) </td><td align="left">On-the-fly calibration, idle counter before calibrating </td><td align="left">v3 </td><td align="left">yes </td><td align="left">no </td></tr>
</table>
<p><b>Joystick settings</b> </p><table class="doxtable">
<tr>
<th align="left">Command </th><th align="left">Parameter </th><th align="left">Description </th><th align="left">Available since </th><th align="left">Implemented in v3 </th><th align="left">fct_* file / handler  </th></tr>
<tr>
<td align="left">AT JX </td><td align="left">number (0-1023) + number(0,1) </td><td align="left">Joystick X-axis <sup><a href="#footnoteD">D</a></sup> </td><td align="left">v2 </td><td align="left">yes </td><td align="left">handler_hid </td></tr>
<tr>
<td align="left">AT JY </td><td align="left">number (0-1023) + number(0,1) </td><td align="left">Joystick Y-axis <sup><a href="#footnoteD">D</a></sup> </td><td align="left">v2 </td><td align="left">yes </td><td align="left">handler_hid </td></tr>
<tr>
<td align="left">AT JZ </td><td align="left">number (0-1023) + number(0,1) </td><td align="left">Joystick Z-axis <sup><a href="#footnoteD">D</a></sup> </td><td align="left">v2 </td><td align="left">yes </td><td align="left">handler_hid </td></tr>
<tr>
<td align="left">AT JT </td><td align="left">number (0-1023) + number(0,1) </td><td align="left">Joystick Z-rotate <sup><a href="#footnoteD">D</a></sup> </td><td align="left">v2 </td><td align="left">yes </td><td align="left">handler_hid </td></tr>
<tr>
<td align="left">AT JS </td><td align="left">number (0-1023) + number(0,1) </td><td align="left">Joystick Slider left <sup><a href="#footnoteD">D</a></sup> </td><td align="left">v2 </td><td align="left">yes </td><td align="left">handler_hid </td></tr>
<tr>
<td align="left">AT JU </td><td align="left">number (0-1023) + number(0,1) </td><td align="left">Joystick Slider right <sup><a href="#footnoteD">D</a></sup> </td><td align="left">v3 </td><td align="left">untested </td><td align="left">handler_hid </td></tr>
<tr>
<td align="left">AT JP </td><td align="left">number (1-32) </td><td align="left">Button press (if assigned to a VB, release depends on button release) </td><td align="left">v2 </td><td align="left">yes </td><td align="left">handler_hid </td></tr>
<tr>
<td align="left">AT JC </td><td align="left">number (1-32) </td><td align="left">Button click </td><td align="left">v3 </td><td align="left">yes </td><td align="left">handler_hid </td></tr>
<tr>
<td align="left">AT JR </td><td align="left">number (1-32) </td><td align="left">Button release </td><td align="left">v2 </td><td align="left">yes </td><td align="left">handler_hid </td></tr>
<tr>
<td align="left">AT JH </td><td align="left">number (-1, 0-7) + number(0,1) </td><td align="left">Joystick hat (rest position: -1, 0-7 (mapped to 45° steps)) <sup><a href="#footnoteD">D</a></sup> </td><td align="left">v2 </td><td align="left">yes </td><td align="left">handler_hid </td></tr>
</table>
<p>Please note, that joystick is currently not available for Bluetooth connections.</p>
<p><a class="anchor" id="footnoteD"></a><b>D</b>: The second parameter sets the release mode of this command.</p>
<p>If set to 0 (or no parameter given, compatible to v2), the axis/slider/hat won't be set to a different value except another VB is used to set it differently.</p>
<p>If set to 1, the axis/slider/hat will be released to its idle position on a VB release action (idle values: axis - 512; slider - 0; hat - -1). In singleshot mode, the release actions is sent immediately afterwards!</p>
<p><b>Infrared commands</b> </p><table class="doxtable">
<tr>
<th align="left">Command </th><th align="left">Parameter </th><th align="left">Description </th><th align="left">Available since </th><th align="left">Implemented in v3 </th><th align="left">fct_* file / handler  </th></tr>
<tr>
<td align="left">AT IR </td><td align="left">string (2-32chars) </td><td align="left">record a new infrared command, store it with the given name </td><td align="left">v2 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT IP </td><td align="left">string (2-32chars) </td><td align="left">replay a recorded IR command, stored with the given name </td><td align="left">v2 </td><td align="left">yes </td><td align="left">fct_infrared </td></tr>
<tr>
<td align="left">AT IH </td><td align="left">string (max: ~250chars) </td><td align="left">play a hex string (replay a given hex string sent by "AT IR") </td><td align="left">v3 </td><td align="left">no </td><td align="left">fct_infrared </td></tr>
<tr>
<td align="left">AT IC </td><td align="left">string (2-32chars) </td><td align="left">clear an IR command, defined by the name </td><td align="left">v2 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT IW </td><td align="left">&ndash; </td><td align="left">wipe all IR commands </td><td align="left">v2 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT IT </td><td align="left">number (2-100) </td><td align="left">timeout for recording IR commands (time[ms] between 2 edges) </td><td align="left">v2 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT IL </td><td align="left"></td><td align="left">list all available stored IR commands </td><td align="left">v2 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT IX </td><td align="left">number (1-99) </td><td align="left">Delete one IR slot. </td><td align="left">v3 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT II </td><td align="left">string (2-32chars) </td><td align="left">Set an idle IR command. Will be sent AFTER EACH normally sent command. </td><td align="left">v2.7 </td><td align="left">no </td><td align="left">no </td></tr>
</table>
<p><b>SmartHome interface</b> </p><table class="doxtable">
<tr>
<th align="left">Command </th><th align="left">Parameter </th><th align="left">Description </th><th align="left">Available since </th><th align="left">Implemented in v3 </th><th align="left">fct_* file / handler  </th></tr>
<tr>
<td align="left">AT MQ </td><td align="left">string (5-240chars) </td><td align="left">publish this data on the given topic, e.g.: "lights/livingroom:ON" <sup><a href="#footnoteE">E</a></sup> </td><td align="left">v3 </td><td align="left">yes </td><td align="left">handler_vb </td></tr>
<tr>
<td align="left">AT MH </td><td align="left">string (6-100chars) </td><td align="left">set a new MQTT broker, e.g.: "mqtt://localhost:1883" <sup><a href="#footnoteE">E</a></sup> </td><td align="left">v3 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT ML </td><td align="left">string (1char) </td><td align="left">set a new MQTT delimiter symbol (topic vs data, default: ":") for AT MQ </td><td align="left">v3 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT WP </td><td align="left">string (8-63chars) </td><td align="left">set a new WiFi password (when this device is connected as WiFi client!) <sup><a href="#footnoteF">F</a></sup> </td><td align="left">v3 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT WH </td><td align="left">string (4-31chars) </td><td align="left">set a new WiFi name to connect to (when this device is connected as WiFi client!) <sup><a href="#footnoteF">F</a></sup> </td><td align="left">v3 </td><td align="left">yes </td><td align="left">no </td></tr>
<tr>
<td align="left">AT RE </td><td align="left">string (8-200chars) </td><td align="left">calling a REST API via HTTP get. If not connected yet, Wifi will be activated in station mode <sup><a href="#footnoteG">G</a></sup> </td><td align="left">v3 </td><td align="left">yes </td><td align="left">handler_vb </td></tr>
</table>
<p><a class="anchor" id="footnoteE"></a><b>E</b>: No QoS or retain flags are implemented for MQTT. Please note, that WiFi is only started on the first execution of an AT MQ command. <a class="anchor" id="footnoteF"></a><b>F</b>: Please note, that WiFi in station mode will be activated on the first call of a WiFi related command (e.g. AT MQ or AT RE). <a class="anchor" id="footnoteG"></a><b>G</b>: Due to a limitation in the esp-idf, you cannot use HTTPS without providing a server certificate. We consider extracting the certificate for each host too complicated, please use HTTP instead. We also thought of integrating the whole Mozilla certificate DB, but this would take REALLY long to try all certificates.</p>
<p>After WiFi is enabled in station mode, it is possible to activate the SoftAP mode for the configuration GUI, but once this is done, the device must be restarted to restore full functionality!</p>
<h2>Button assignments - FLipMouse</h2>
<p>The FLipMouse version 2 has 1 internal push-button and 2 jack plugs for external buttons. Version 3 uses the second internal button, which was previously the program button for the Teensy, as virtual button 0.</p>
<p><b>Note:</b> VB0 (internal button 2) is configured as activation button to switch on/off WiFi for configuring the FLipMouse. Feedback to the user is still not defined, will be announced here.</p>
<p>In addition other functions are mapped to virtual buttons, so they can be configured the same. Following number mapping is used for the <b>AT BM</b> command:</p>
<table class="doxtable">
<tr>
<th align="left">VB nr </th><th align="left">Function  </th></tr>
<tr>
<td align="left">0 </td><td align="left">Internal button 2 </td></tr>
<tr>
<td align="left">1 </td><td align="left">Internal button 1 </td></tr>
<tr>
<td align="left">2 </td><td align="left">External button 1 </td></tr>
<tr>
<td align="left">3 </td><td align="left">External button 2 </td></tr>
<tr>
<td align="left">4 </td><td align="left">Mouthpiece in threshold mode: UP </td></tr>
<tr>
<td align="left">5 </td><td align="left">Mouthpiece in threshold mode: DOWN </td></tr>
<tr>
<td align="left">6 </td><td align="left">Mouthpiece in threshold mode: LEFT </td></tr>
<tr>
<td align="left">7 </td><td align="left">Mouthpiece in threshold mode: RIGHT </td></tr>
<tr>
<td align="left">8 </td><td align="left">Sip </td></tr>
<tr>
<td align="left">9 </td><td align="left">Puff </td></tr>
<tr>
<td align="left">10 </td><td align="left">Strong Sip </td></tr>
<tr>
<td align="left">11 </td><td align="left">Strong Puff </td></tr>
<tr>
<td align="left">12 </td><td align="left">Strong Sip + Up </td></tr>
<tr>
<td align="left">13 </td><td align="left">Strong Sip + Down </td></tr>
<tr>
<td align="left">14 </td><td align="left">Strong Sip + Left </td></tr>
<tr>
<td align="left">15 </td><td align="left">Strong Sip + Right </td></tr>
<tr>
<td align="left">16 </td><td align="left">Strong Puff + Up </td></tr>
<tr>
<td align="left">17 </td><td align="left">Strong Puff + Down </td></tr>
<tr>
<td align="left">18 </td><td align="left">Strong Puff + Left </td></tr>
<tr>
<td align="left">19 </td><td align="left">Strong Puff + Right </td></tr>
</table>
<p>These assignments are declared in file <a class="el" href="common_8h.html" title="Common data structs and IPC pointers for the firmware. ">common.h</a>.</p>
<p><b>Note:</b> The C# GUI starts with VB 1, so it cannot configure the internal button.</p>
<h2>Button assignments - FABI</h2>
<p>The FABI supports up to 9 buttons (normally external, but they can be hardwired like internal buttons). In addition, one analog channel is support for sip/puff functionality. Following number mapping is used for the <b>AT BM</b> command:</p>
<table class="doxtable">
<tr>
<th align="left">VB nr </th><th align="left">Function  </th></tr>
<tr>
<td align="left">0 </td><td align="left">Button 1 </td></tr>
<tr>
<td align="left">1 </td><td align="left">Button 2 </td></tr>
<tr>
<td align="left">2 </td><td align="left">Button 3 </td></tr>
<tr>
<td align="left">3 </td><td align="left">Button 4 </td></tr>
<tr>
<td align="left">4 </td><td align="left">Button 5 </td></tr>
<tr>
<td align="left">5 </td><td align="left">Button 6 </td></tr>
<tr>
<td align="left">6 </td><td align="left">Button 7 </td></tr>
<tr>
<td align="left">7 </td><td align="left">Button 8 </td></tr>
<tr>
<td align="left">8 </td><td align="left">Button 9 </td></tr>
<tr>
<td align="left">9 </td><td align="left">Sip </td></tr>
<tr>
<td align="left">10 </td><td align="left">Puff </td></tr>
<tr>
<td align="left">11 </td><td align="left">Long Press Button 1 </td></tr>
<tr>
<td align="left">12 </td><td align="left">Long Press Button 2 </td></tr>
<tr>
<td align="left">13 </td><td align="left">Long Press Button 3 </td></tr>
<tr>
<td align="left">14 </td><td align="left">Long Press Button 4 </td></tr>
<tr>
<td align="left">15 </td><td align="left">Long Press Button 5 </td></tr>
<tr>
<td align="left">16 </td><td align="left">Long Press Button 6 </td></tr>
<tr>
<td align="left">17 </td><td align="left">Long Press Button 7 </td></tr>
<tr>
<td align="left">18 </td><td align="left">Long Press Button 8 </td></tr>
<tr>
<td align="left">19 </td><td align="left">Long Press Button 9 </td></tr>
</table>
<p>These assignments are declared in file <a class="el" href="common_8h.html" title="Common data structs and IPC pointers for the firmware. ">common.h</a>.</p>
<p><b>Note:</b> The FABI C# GUI cannot configure VB0, a solution is pending.</p>
<h2>Key identifiers</h2>
<p>The key identifiers are necessary to determine which key should be pressed or released by either the <b>AT KP</b> or the <b>AT KR</b> command. Following keys are possible: </p><pre class="fragment">KEY_A   KEY_B   KEY_C   KEY_D    KEY_E   KEY_F   KEY_G   KEY_H   KEY_I   KEY_J    KEY_K    KEY_L
KEY_M   KEY_N   KEY_O   KEY_P    KEY_Q   KEY_R   KEY_S   KEY_T   KEY_U   KEY_V    KEY_W    KEY_X 
KEY_Y   KEY_Z   KEY_1   KEY_2    KEY_3   KEY_4   KEY_5   KEY_6   KEY_7   KEY_8    KEY_9    KEY_0
KEY_F1  KEY_F2  KEY_F3  KEY_F4   KEY_F5  KEY_F6  KEY_F7  KEY_F8  KEY_F9  KEY_F10  KEY_F11  KEY_F12

KEY_RIGHT   KEY_LEFT       KEY_DOWN        KEY_UP      KEY_ENTER    KEY_ESC   KEY_BACKSPACE   KEY_TAB   
KEY_HOME    KEY_PAGE_UP    KEY_PAGE_DOWN   KEY_DELETE  KEY_INSERT   KEY_END   KEY_NUM_LOCK    KEY_SCROLL_LOCK
KEY_SPACE   KEY_CAPS_LOCK  KEY_PAUSE       KEY_SHIFT   KEY_CTRL     KEY_ALT   KEY_RIGHT_ALT   KEY_GUI 
KEY_RIGHT_GUI 
</pre><p>New in version 3: </p><pre class="fragment">KEY_F13     KEY_F14     KEY_F15     KEY_F16     KEY_F17     KEY_F18     
KEY_F19     KEY_F20     KEY_F21     KEY_F22     KEY_F23     KEY_F24
KEY_MEDIA_POWER         KEY_MEDIA_RESET         KEY_MEDIA_SLEEP
KEY_MEDIA_MENU          KEY_MEDIA_SELECTION     KEY_MEDIA_ASSIGN_SEL
KEY_MEDIA_MODE_STEP     KEY_MEDIA_RECALL_LAST   KEY_MEDIA_QUIT
KEY_MEDIA_HELP          KEY_MEDIA_CHANNEL_UP    KEY_MEDIA_CHANNEL_DOWN
KEY_MEDIA_SELECT_DISC   KEY_MEDIA_ENTER_DISC    KEY_MEDIA_REPEAT
KEY_MEDIA_VOLUME        KEY_MEDIA_BALANCE       KEY_MEDIA_BASS

KEY_MEDIA_PLAY          KEY_MEDIA_PAUSE         KEY_MEDIA_RECORD
KEY_MEDIA_FAST_FORWARD  KEY_MEDIA_REWIND        KEY_MEDIA_NEXT_TRACK
KEY_MEDIA_PREV_TRACK    KEY_MEDIA_STOP          KEY_MEDIA_EJECT
KEY_MEDIA_RANDOM_PLAY   KEY_MEDIA_STOP_EJECT    KEY_MEDIA_PLAY_PAUSE
KEY_MEDIA_PLAY_SKIP     KEY_MEDIA_MUTE          KEY_MEDIA_VOLUME_INC
KEY_MEDIA_VOLUME_DEC

KEY_SYSTEM_POWER_DOWN   KEY_SYSTEM_SLEEP        KEY_SYSTEM_WAKE_UP
KEY_MINUS               KEY_EQUAL               KEY_LEFT_BRACE
KEY_RIGHT_BRACE         KEY_BACKSLASH           KEY_SEMICOLON
KEY_QUOTE               KEY_TILDE               KEY_COMMA
KEY_PERIOD              KEY_SLASH               KEY_PRINTSCREEN
KEY_MENU

KEYPAD_SLASH            KEYPAD_ASTERIX          KEYPAD_MINUS
KEYPAD_PLUS             KEYPAD_ENTER            KEYPAD_1
KEYPAD_2                KEYPAD_3                KEYPAD_4
KEYPAD_5                KEYPAD_6                KEYPAD_7
KEYPAD_8                KEYPAD_9                KEYPAD_0
</pre><p>All possible key identifiers are defined in keylayouts.h (no doxygen available, please use the source).</p>
<h2>Keyboard locales</h2>
<p>With firmware version 3 it is possible to change the keyboard layout of FLipMouse/FABI by the <b>AT KL</b> command. Please note that the keyboard layout is only relevant for the <b>AT KW</b> command, where an ASCII/Unicode text is written by the FLipMouse/FABI. AT commands controlled by key identifiers (e.g., KEY_Y, KEY_Z) are mapped to an american layout.</p>
<p>It is recommended to use the <b>AT KW</b> command as much as possible when typing text. For keyboard shortcuts, press&amp;release actuated programs <b>AT KP/KH/KR</b> is recommended.</p>
<p>Following keyboard locales are currently available:</p>
<table class="doxtable">
<tr>
<th align="left">Keyboard locale </th><th align="left">Number (parameter for <b>AT KL</b> )  </th></tr>
<tr>
<td align="left">LAYOUT_US_ENGLISH </td><td align="left">0 </td></tr>
<tr>
<td align="left">LAYOUT_US_INTERNATIONAL </td><td align="left">1 </td></tr>
<tr>
<td align="left">LAYOUT_GERMAN </td><td align="left">2 </td></tr>
<tr>
<td align="left">LAYOUT_GERMAN_MAC </td><td align="left">3 </td></tr>
<tr>
<td align="left">LAYOUT_CANADIAN_FRENCH </td><td align="left">4 </td></tr>
<tr>
<td align="left">LAYOUT_CANADIAN_MULTILINGUAL </td><td align="left">5 </td></tr>
<tr>
<td align="left">LAYOUT_UNITED_KINGDOM </td><td align="left">6 </td></tr>
<tr>
<td align="left">LAYOUT_FINNISH </td><td align="left">7 </td></tr>
<tr>
<td align="left">LAYOUT_FRENCH </td><td align="left">8 </td></tr>
<tr>
<td align="left">LAYOUT_DANISH </td><td align="left">9 </td></tr>
<tr>
<td align="left">LAYOUT_NORWEGIAN </td><td align="left">10 </td></tr>
<tr>
<td align="left">LAYOUT_SWEDISH </td><td align="left">11 </td></tr>
<tr>
<td align="left">LAYOUT_SPANISH </td><td align="left">12 </td></tr>
<tr>
<td align="left">LAYOUT_PORTUGUESE </td><td align="left">13 </td></tr>
<tr>
<td align="left">LAYOUT_ITALIAN </td><td align="left">14 </td></tr>
<tr>
<td align="left">LAYOUT_PORTUGUESE_BRAZILIAN </td><td align="left">15 </td></tr>
<tr>
<td align="left">LAYOUT_FRENCH_BELGIAN </td><td align="left">16 </td></tr>
<tr>
<td align="left">LAYOUT_GERMAN_SWISS </td><td align="left">17 </td></tr>
<tr>
<td align="left">LAYOUT_FRENCH_SWISS </td><td align="left">18 </td></tr>
<tr>
<td align="left">LAYOUT_SPANISH_LATIN_AMERICA </td><td align="left">19 </td></tr>
<tr>
<td align="left">LAYOUT_IRISH </td><td align="left">20 </td></tr>
<tr>
<td align="left">LAYOUT_ICELANDIC </td><td align="left">21 </td></tr>
<tr>
<td align="left">LAYOUT_TURKISH </td><td align="left">22 </td></tr>
<tr>
<td align="left">LAYOUT_CZECH </td><td align="left">23 </td></tr>
<tr>
<td align="left">LAYOUT_SERBIAN_LATIN_ONLY </td><td align="left">24 </td></tr>
</table>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
